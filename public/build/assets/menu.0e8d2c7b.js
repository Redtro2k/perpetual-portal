import{m as N,y as L,h as j,F as B,o as d,c as K,u as U,l as k,P as h,t as D,p as $,R as w,a as p,v as V,M as E,D as C,O as _}from"./use-outside-click.39d564af.js";import{x as q,a as g}from"./calculate-active-index.804d077d.js";import{P as F,M as P,d as S,j as x,p as O,q as Q,Q as W,O as H,U as M}from"./app.69e48e67.js";import{b as G}from"./use-resolve-button-type.41d4d527.js";function J({container:n,accept:f,walk:I,enabled:m}){F(()=>{let e=n.value;if(!e||m!==void 0&&!m.value)return;let v=N(n);if(!v)return;let u=Object.assign(r=>f(r),{acceptNode:f}),c=v.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,u,!1);for(;c.nextNode();)I(c.currentNode)})}var X=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(X||{}),Y=(n=>(n[n.Pointer=0]="Pointer",n[n.Other=1]="Other",n))(Y||{});function z(n){requestAnimationFrame(()=>requestAnimationFrame(n))}let A=Symbol("MenuContext");function y(n){let f=W(A,null);if(f===null){let I=new Error(`<${n} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(I,y),I}return f}let ne=P({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(n,{slots:f,attrs:I}){let m=S(1),e=S(null),v=S(null),u=S([]),c=S(""),r=S(null),b=S(1);function s(o=a=>a){let a=r.value!==null?u.value[r.value]:null,l=_(o(u.value.slice()),R=>d(R.dataRef.domRef)),i=a?l.indexOf(a):null;return i===-1&&(i=null),{items:l,activeItemIndex:i}}let t={menuState:m,buttonRef:e,itemsRef:v,items:u,searchQuery:c,activeItemIndex:r,activationTrigger:b,closeMenu:()=>{m.value=1,r.value=null},openMenu:()=>m.value=0,goToItem(o,a,l){let i=s(),R=q(o===g.Specific?{focus:g.Specific,id:a}:{focus:o},{resolveItems:()=>i.items,resolveActiveIndex:()=>i.activeItemIndex,resolveId:T=>T.id,resolveDisabled:T=>T.dataRef.disabled});c.value="",r.value=R,b.value=l!=null?l:1,u.value=i.items},search(o){let a=c.value!==""?0:1;c.value+=o.toLowerCase();let l=(r.value!==null?u.value.slice(r.value+a).concat(u.value.slice(0,r.value+a)):u.value).find(R=>R.dataRef.textValue.startsWith(c.value)&&!R.dataRef.disabled),i=l?u.value.indexOf(l):-1;i===-1||i===r.value||(r.value=i,b.value=1)},clearSearch(){c.value=""},registerItem(o,a){let l=s(i=>[...i,{id:o,dataRef:a}]);u.value=l.items,r.value=l.activeItemIndex,b.value=1},unregisterItem(o){let a=s(l=>{let i=l.findIndex(R=>R.id===o);return i!==-1&&l.splice(i,1),l});u.value=a.items,r.value=a.activeItemIndex,b.value=1}};return L([e,v],(o,a)=>{var l;t.closeMenu(),j(a,B.Loose)||(o.preventDefault(),(l=d(e))==null||l.focus())},x(()=>m.value===0)),H(A,t),K(x(()=>U(m.value,{[0]:k.Open,[1]:k.Closed}))),()=>{let o={open:m.value===0,close:t.closeMenu};return h({ourProps:{},theirProps:n,slot:o,slots:f,attrs:I,name:"Menu"})}}}),le=P({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"}},setup(n,{attrs:f,slots:I,expose:m}){let e=y("MenuButton"),v=`headlessui-menu-button-${D()}`;m({el:e.buttonRef,$el:e.buttonRef});function u(s){switch(s.key){case p.Space:case p.Enter:case p.ArrowDown:s.preventDefault(),s.stopPropagation(),e.openMenu(),M(()=>{var t;(t=d(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(g.First)});break;case p.ArrowUp:s.preventDefault(),s.stopPropagation(),e.openMenu(),M(()=>{var t;(t=d(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(g.Last)});break}}function c(s){switch(s.key){case p.Space:s.preventDefault();break}}function r(s){n.disabled||(e.menuState.value===0?(e.closeMenu(),M(()=>{var t;return(t=d(e.buttonRef))==null?void 0:t.focus({preventScroll:!0})})):(s.preventDefault(),e.openMenu(),z(()=>{var t;return(t=d(e.itemsRef))==null?void 0:t.focus({preventScroll:!0})})))}let b=G(x(()=>({as:n.as,type:f.type})),e.buttonRef);return()=>{var s;let t={open:e.menuState.value===0},o={ref:e.buttonRef,id:v,type:b.value,"aria-haspopup":!0,"aria-controls":(s=d(e.itemsRef))==null?void 0:s.id,"aria-expanded":n.disabled?void 0:e.menuState.value===0,onKeydown:u,onKeyup:c,onClick:r};return h({ourProps:o,theirProps:n,slot:t,attrs:f,slots:I,name:"MenuButton"})}}}),ue=P({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0}},setup(n,{attrs:f,slots:I,expose:m}){let e=y("MenuItems"),v=`headlessui-menu-items-${D()}`,u=S(null);m({el:e.itemsRef,$el:e.itemsRef}),J({container:x(()=>d(e.itemsRef)),enabled:x(()=>e.menuState.value===0),accept(t){return t.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:t.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(t){t.setAttribute("role","none")}});function c(t){var o;switch(u.value&&clearTimeout(u.value),t.key){case p.Space:if(e.searchQuery.value!=="")return t.preventDefault(),t.stopPropagation(),e.search(t.key);case p.Enter:if(t.preventDefault(),t.stopPropagation(),e.activeItemIndex.value!==null){let a=e.items.value[e.activeItemIndex.value];(o=d(a.dataRef.domRef))==null||o.click()}e.closeMenu(),C(d(e.buttonRef));break;case p.ArrowDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(g.Next);case p.ArrowUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(g.Previous);case p.Home:case p.PageUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(g.First);case p.End:case p.PageDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(g.Last);case p.Escape:t.preventDefault(),t.stopPropagation(),e.closeMenu(),M(()=>{var a;return(a=d(e.buttonRef))==null?void 0:a.focus({preventScroll:!0})});break;case p.Tab:t.preventDefault(),t.stopPropagation(),e.closeMenu(),M(()=>V(d(e.buttonRef),t.shiftKey?E.Previous:E.Next));break;default:t.key.length===1&&(e.search(t.key),u.value=setTimeout(()=>e.clearSearch(),350));break}}function r(t){switch(t.key){case p.Space:t.preventDefault();break}}let b=$(),s=x(()=>b!==null?b.value===k.Open:e.menuState.value===0);return()=>{var t,o;let a={open:e.menuState.value===0},l={"aria-activedescendant":e.activeItemIndex.value===null||(t=e.items.value[e.activeItemIndex.value])==null?void 0:t.id,"aria-labelledby":(o=d(e.buttonRef))==null?void 0:o.id,id:v,onKeydown:c,onKeyup:r,role:"menu",tabIndex:0,ref:e.itemsRef};return h({ourProps:l,theirProps:n,slot:a,attrs:f,slots:I,features:w.RenderStrategy|w.Static,visible:s.value,name:"MenuItems"})}}}),oe=P({name:"MenuItem",props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1}},setup(n,{slots:f,attrs:I,expose:m}){let e=y("MenuItem"),v=`headlessui-menu-item-${D()}`,u=S(null);m({el:u,$el:u});let c=x(()=>e.activeItemIndex.value!==null?e.items.value[e.activeItemIndex.value].id===v:!1),r=x(()=>({disabled:n.disabled,textValue:"",domRef:u}));O(()=>{var a,l;let i=(l=(a=d(u))==null?void 0:a.textContent)==null?void 0:l.toLowerCase().trim();i!==void 0&&(r.value.textValue=i)}),O(()=>e.registerItem(v,r)),Q(()=>e.unregisterItem(v)),F(()=>{e.menuState.value===0&&(!c.value||e.activationTrigger.value!==0&&M(()=>{var a,l;return(l=(a=d(u))==null?void 0:a.scrollIntoView)==null?void 0:l.call(a,{block:"nearest"})}))});function b(a){if(n.disabled)return a.preventDefault();e.closeMenu(),C(d(e.buttonRef))}function s(){if(n.disabled)return e.goToItem(g.Nothing);e.goToItem(g.Specific,v)}function t(){n.disabled||c.value||e.goToItem(g.Specific,v,0)}function o(){n.disabled||!c.value||e.goToItem(g.Nothing)}return()=>{let{disabled:a}=n,l={active:c.value,disabled:a,close:e.closeMenu};return h({ourProps:{id:v,ref:u,role:"menuitem",tabIndex:a===!0?void 0:-1,"aria-disabled":a===!0?!0:void 0,onClick:b,onFocus:s,onPointermove:t,onMousemove:t,onPointerleave:o,onMouseleave:o},theirProps:n,slot:l,attrs:I,slots:f,name:"MenuItem"})}}});export{le as I,oe as S,ue as g,J as p,ne as v};
